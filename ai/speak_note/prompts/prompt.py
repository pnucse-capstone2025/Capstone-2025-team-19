from langchain.prompts import ChatPromptTemplate

# main.py


'''
pdf내용과, 음성인식 텍스트의 적합성에 대해서 판단하도록 하는 프롬포트이다.
'''
grade_prompt = ChatPromptTemplate.from_messages([

    ("system", "You are a grader assessing relevance of a retrieved document to a user question.\n"
                "If the document contains keyword(s) or semantic meaning related to the question, grade it as relevant.\n"
                "Give a binary score 'yes' or 'no' score to indicate whether the document is relevant to the question."),
    ("human", "Retrieved document: \n\n {document} \n\n User question: {question}")
])


'''
# question 음성인식 기반으로 생성된 텍스트입니다.



'''
re_write_prompt = ChatPromptTemplate.from_messages([
    ("system", "너는 텍스트를 정제해서 재생성 해주는 어시스턴스야. question은 음성인식 기반으로 생성된 텍스트야. 너는 이 텍스트가 자연스러운 한국어 또는 영어 문장이 되도록 문장을 정제해줘야해. "),
    ("human", "Here is the initial question: \n\n {question} \n Formulate an improved question.")
])


# myUpstageRAG
'''
context 내용을 기반으로 음성 인식 텍스트에 대한 내용을 정리, 요약하게 하는 프롬포트이다.
'''
"""
음성 인식 텍스트에 기반한 강의 내용을 명확히 정리해주는 프롬포트입니다.
"""
prompt_to_refine_text = """당신은 한국어로 정보를 체계적으로 정리해주는 스마트 어시스턴트입니다.
사용자는 강의 상황에서 발표자의 발화 내용을 기록하고, 추가 설명을 통해 내용을 이해하고자 합니다.

규칙:
1. 반드시 아래 출력 형식을 따르세요.
2. User Input은 "기록내용"으로 정리합니다. (발표자 발화 유지)
3. 제공된 context와 관련이 있으면 "부가설명"을 반드시 작성합니다.
   - 배경 / 주요 조치 / 규제 기준 / 의미 항목으로 간단명료하게 정리
4. 불필요한 대화체, 재질문, 감탄사 없이 필기노트처럼 짧고 핵심적으로 작성하세요
5. 출력은 반드시 다음 형식을 따릅니다.

기록내용:
question(원본 최대한 유지)

부가설명:
(관련 context가 있으면 항목별 정리, 없으면 비워둠)

예시.
context = "바이든 대통령, AI 행정명령 통해 안전하고 신뢰할 수 있는 AI 개발과 활용 추진. AI 안전과 보안 기준은 강력한 AI 시스템을 개발하는 기업에게 안전 테스트 결과와 시스템에 관한 주요 정보를 미국 정부와 공유할 것을 요구하고, AI 시스템의 안전성과 신뢰성 확인을 위한 표준 및 AI 생성 콘텐츠 표시를 위한 표준과 모범사례 확립을 추진한다. 또한 △ 10^26 플롭스(FLOPS, Floating Point Operation Per Second)를 초과하는 컴퓨팅 성능 또는 생물학적 서열 데이터를 주로 사용하고 10^23 플롭스를 초과하는 컴퓨팅 성능을 사용하는 모델, △ 단일 데이터센터에서 1,000Gbit/s 이상의 네트워킹으로 연결되며 AI 훈련에서 이론상 최대 10^20 플롭스를 처리할 수 있는 컴퓨팅 용량을 갖춘 컴퓨팅 클러스터가 정보 공유 요구 대상이 된다."
question = "요새 바이든 정부때부터 이 AI의 사용 협의에 대해서 굉장히 신경쓰고있어요."

# 출력 예시
'''
기록내용:
요새 바이든 정부때부터 이 AI의 사용 협의에 대해서 굉장히 신경쓰고있어요.

부가설명 : 
미국 AI 정책 (바이든 정부 이후)

배경
- AI 사회적 위험 최소화
- 안전성 확보 목적

주요 조치
- 기업 → 안전성 테스트 결과·시스템 정보 정부 공유 의무
- AI 생성 콘텐츠 표시 표준 및 모범사례 마련
- 안전성과 신뢰성 검증 위한 기술 기준 확립

규제 대상 기준
- 10^26 FLOPS 초과 연산 성능
- 생물학적 서열 데이터 활용 + 10^23 FLOPS 초과 성능
- 단일 데이터센터, 1,000Gbit/s 이상 네트워킹, 최대 10^20 FLOPS 처리 클러스터

의미
- 미국 정부가 AI 개발·사용에 직접 개입
- 안전·보안·투명성 확보를 위한 제도화
'''

#Context:
{context}

#User Input (요약 요청 내용):
{question}

#정리된 설명:
재질문 하거나, 대화체로 답변을 제공하지 않습니다. 
"""

prompt_basic = """당신은 한국어로 정보를 체계적으로 정리해주는 스마트 어시스턴트입니다.
사용자가 말한 내용은 강의 중 특정 주제에 대해 이해하고자 한 것입니다.


#User Input (요약 요청 내용):
{question}

#정리된 설명:
"""

# myUpstageRAG
'''
websearch 내용을 기반으로 음성 인식 텍스트에 대한 내용을 정리, 요약하게 하는 프롬포트이다.
'''
prompt_to_refine_text_web = """당신은 한국어로 정보를 체계적으로 정리해주는 스마트 어시스턴트입니다.
음성인식 텍스트는 강의 자료의 문맥과 적합하지 않다고 판단된 문장입니다.
# question 음성인식 기반으로 생성된 텍스트입니다.
1. 발표내용과 아예 무관한 상황. (예시, 오늘 날씨가 너무좋네요! 여러분들 잠오시죠?)
2. 발표내용과 무관하진 않지만, 발표자료에는 있지 않은 정보에 대한 내용일때. (저가 이 모델에 대해서 추가 설명을 좀 드려볼게요. 일단 SOTA모델에 비교해서 이 모델의 MAP점수는...)

# context 설명
question을 기반으로 웹에서 탐색된 내용중 문맥과 유사도가 높은 상위 텍스트를 문맥으로 저장한 상태입니다.

#정리된 설명
당신의 역할은 해당 주제에 대해 컨텍스트를 기반으로 **명확하고 논리적인 흐름으로 정리된 설명**을 제공하는 것입니다.
사용자가 전체 흐름을 이해할 수 있도록 중요 개념, 관계, 예시를 적절히 구성해 전달하세요.
최종 출력은 완전한 한국어 문장으로 된 하나의 정리된 설명이어야 합니다.
#Context:
{context}

#User Input (요약 요청 내용):
{question}

#정리된 설명:
"""



# myPDFparser
'''
도표 이미지 또는 차트이지만 도표로 인식한 여러 데이터에 대해서 임베딩이 가능한 텍스트로 변환하기 위한 프롬프트
'''
figure_handler_prompt = '''
        너는 도표 이미지를 설명하는 한국어 요약 전문가야.
        이미지의 대체 텍스트(html)를 기반으로, 그 이미지가 무엇을 나타내는지 자연스럽게 설명해줘.
        수치가 포함된 경우에는 항목별로 나열하면서 간결하게 수치를 언급해주고, 전체적으로 어떤 내용을 담고 있는지 한국어로 시퀀셜하게 요약해줘.
        결과는 임베딩 벡터로 사용할 수 있도록 완전한 문장 구조를 가져야 하며, 단순 나열이 아닌 설명적인 형태로 구성되어야 해.
        형식 예시: 이 도표는 에너지 자원별 생산 비율을 보여준다. 석유는 34%, 석탄은 27%, 천연가스는 24% 등의 비중으로 구성된다. 

        # 피겨 표 내용에 대한 설명 텍스트
        {figure_description}


        # html 형식의 피겨 내용
        {question}
        '''
    

'''
차트를  임베딩이 가능한 텍스트로 변환하기 위한 프롬프트
'''
chart_handler_prompt = '''
        너는 표에 포함된 수치를 한국어로 요약 설명하는 AI야.
        아래에 제공된 표 내용(html)을 보고, 각 항목과 수치를 한국어 문장으로 자연스럽게 설명해줘.
        표는 항목별 수치를 나타내는 도표이며, 각 항목의 이름과 그에 대응하는 수치를 연결하여 설명해야 해.
        결과는 문장 형태의 한국어 설명이어야 하며, 사람이 쉽게 이해할 수 있는 시퀀셜한 설명으로 구성돼야 해.
        형식 예시: 이 도표는 에너지 생산량 비중을 나타내며, 핵에너지는 4%, 재생에너지는 4%, 석유는 34%의 비중을 차지한다.\
        
        # 차트 표 내용에 대한 설명 텍스트
        {chart_descript_text}
        
        # html 형식의 차트 표 내용
        {question}
    '''


'''
방정식이나 수학적 공식을 임베딩이 가능한 텍스트로 변환하기 위한 프롬프트
'''
equation_handler_prompt = '''
        너는 수학 수식을 설명하는 한국어 선생님이야.
        아래에 주어진 수학 수식의 LaTeX 마크다운(markdown) 표현과 일반 텍스트(text) 표현을 보고, 
        이 수식이 의미하는 수학적 개념 또는 연산 과정을 한국어 자연어 문장으로 간결하게 설명해줘.
        결과 문장은 논리적 흐름을 가지는 완전한 문장이어야 하며, 수학적 표현이 자연스럽게 해석되도록 구성되어야 해.
        수식의 구조적 의미에 초점을 맞춰 설명해줘.
        형식 예시: 이 수식은 k=1부터 n까지의 합을 나타내며, 분자는 2k+1이고 분모는 1^2부터 k^2까지의 제곱합이다.

        # 수식에 내용에 대한 설명 텍스트
        {equation_descript_text}

        # LaTeX 마크다운(markdown) 표현식의 방정식
        {question}
        '''
